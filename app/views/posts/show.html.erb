<style>
.undisplay-field {
    display: none;
}
.main-container {
    margin: 0px auto;
    width: 80%;
}
.icons {
    width: 100%;
}
.icon-box {
    display: flex;
    justify-content: space-around;
}
.icon {
    background-color: #fff;
    border: none;
    color: black;
}
.main {
    width: 50%;
}
.comment-container {
    border-bottom: 1px solid;
}
.name-box {
    display: flex;
    align-items: center;
}
</style>
<div class="main container">
    <div class="row">
        <div class="col-1">
            <%= image_tag @post.user.image_url, size: "50x50", class:"rounded-circle" if @post.user.image? %>
        </div>
        <div class="col-11 name-box">
            <%= link_to user_path(@post.user_id) do %>
                <%= @post.user.name %><br>
            <% end %>
        </div>
    </div>

    <div class="row">
        <div class="col-12">
            <%= @post.body %>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="icons container">
                <div class="row">
                    <div class="col-3 icon-box">
                        <div id="post_likes_buttons_<%= @post.id %>">
                            <%= render partial: 'post_likes/like', locals: { post: @post } %>
                        </div>
                    </div>
                    <div class="col-3 icon-box">
                        <%= link_to  post_path(@post.id) do %>
                            <i class="fas fa-file-alt"></i>
                        <% end %>
                    </div>
                    <% if user_signed_in? && current_user.id == @post.user_id %>
                        <div class="col-3 icon-box">
                            <%= link_to edit_post_path(@post.id) do %>
                                <i class="fas fa-pen"></i>
                            <% end %>
                        </div>
                        <div class="col-3 icon-box">
                            <%= link_to post_path(@post.id), method: :delete, data: { confirm: '削除しますか？' } do %>
                                <i class="fas fa-trash-alt"></i>
                            <% end %>
                        </div>
                    <% end %>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <%= image_tag @post.image_url, size: "500x500" if @post.image? %>
        </div>
    </div>
    <% @post.comments.each do |comment| %>
        <div class="row comment-container">
            <div class="col-1">
                <%= image_tag comment.user.image_url, size: "50x50", class:"rounded-circle" if comment.user.image? %>
            </div>
            <div class="col-5">
                <%= comment.user.name %><br>
                <%= comment.body %>
            </div>
            <div class="col-3">
                <div class="icons container">
                    <div class="row">
                        <div class="col-6 icon-box">
                            <div id="comment_likes_buttons_<%= comment.id %>">
                                <%= render partial: 'comment_likes/like', locals: { comment: comment, post: @post } %>
                            </div>
                        </div>
                        <div class="col-6 icon-box">
                            <% if user_signed_in? && current_user.id == comment.user_id %>
                                <%= link_to post_comment_path(post_id:@post.id ,id:comment.id), method: :delete, data: { confirm: '削除しますか？' } do %>
                                    <i class="fas fa-trash-alt"></i>
                                <% end %>
                            <% end %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <% end %>
    <%= form_with(model: [@post, @comment]) do |f| %>
    <div class="row">
        <div class="col-11">
            <div class="post-comment-field">
                <%= f.text_field :body, :placeholder => "コメントを入力して下さい", :size => 140, class:"post-commentform-field" %>
            </div>
        </div>
        <div class="undisplay-field">
            <%= f.text_field :post_id %>
        </div>
        <div class="col-1">
            <%= button_tag type: :submit, class:"icon" do %>
                <i class="far fa-comment"></i>
            <% end %>
        </div>
    </div>
<% end %>
</div>

<style>
    .post-commentform-field {
        width: 100%;
    }
</style>